<!DOCTYPE html>
<html>
<head>
	<title>MUN Helper</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

	<!-- jQuery library -->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
	<script type="text/javascript" src="script.js"></script>
	<script src="https://cdn.firebase.com/js/client/2.4.0/firebase.js"></script>

	<!-- Latest compiled JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
</head>
<body>
	<style>
		h1{
			padding-right: 10%;
			padding-left: 10%;
		}
		.list-group{
			padding-right: 20%;
			padding-left: 20%;
		}
		.btn-primary{
			padding-left: 10%;
			padding-right: 10%;
		}
	</style>
	<h1>
		Add Countries or Members that will be attending the conference. This will be used for roll call in committee sessions.
	</h1>
	<script>
		function createCountry() {
			var listItem = document.createElement("li");
			listItem.className += "list-group-item"
			var input = document.createElement("input")
			input.className += "form-control country-name-textbox";
			input.type = "text";
			input.id = "cmt";
			input.name = "speaker"
			listItem.appendChild(input);
			var list = document.getElementsByName("countries-list")[0];
			list.appendChild(listItem);
		}

		function createRollCall() {
			var firebase = new Firebase("https://munhelper.firebaseio.com/motion-speakers/" + localStorage.getItem("committee-name"))
			var countries = document.getElementsByClassName("country-name-textbox");
			console.log("elements: " + countries[0] + " " + countries[1])
			var data = {}
			for (var i = 0; i < countries.length - 1; i++) {
				data[i] = countries[i].value;
			};
			console.log(data)
			firebase.authWithPassword({
				email    : localStorage.getItem("email"),
				password : localStorage.getItem("password")
			}, function(error, authData) {
				if (error) {
					console.log("Login Failed!", error);
					window.alert("Login failed");
				} else {
					console.log("Authenticated successfully with payload:", authData);
					firebase.update(data, function(error) {
						if (error) {
							console.log('Synchronization failed');
						} else {
							console.log('Synchronization succeeded');
							window.location.replace("main.html");
						}
					});
				}
			});
		}
	</script>

	<ul class="list-group" name="countries-list">
		<li class="list-group-item"><input type="text" class="form-control country-name-textbox" id="cmt" name="speaker" placeholder="Poland"></li>
	</ul>
	<br>
	<div style="text-align: center;">
		<a class="btn btn-primary" onclick="createCountry();" name="create">Add a Country</a>
		<a class="btn btn-primary" onclick="createRollCall();" name="submit">Submit</a>
	</div>
</body>
</html>